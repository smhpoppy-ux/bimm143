---
title: "class09miniproj"
author: "sylvia ho a18482382"
format: pdf
---

## bg
ggplot , stats, corr analysis, principal component analysis
##data import
csv from 538
```{r}
candy_file <- read.csv(url("https://raw.githubusercontent.com/fivethirtyeight/data/master/candy-power-ranking/candy-data.csv"))

candy = data.frame(candy_file, row.names="competitorname")
head(candy)
```

## exploratory nalyss
>q1 85 rows

```{r}
nrow(candy)
```
> q2 38

```{r}
sum(candy$fruity)
```

```{r}
library(dplyr)

candy |> 
  filter(row.names(candy)=="Twix") |> 
  select(winpercent)
```
> q3 49.52411

```{r}
candy |> 
  filter(row.names(candy)=="Whoppers") |> 
  select(winpercent)
```
>q4 76.77

```{r}
candy |> 
  filter(row.names(candy)=="Kit Kat") |> 
  select(winpercent)

```

>q5 49.6535

```{r}
candy |> 
  filter(row.names(candy)=="Tootsie Roll Snack Bars") |> 
  select(winpercent)
```

```{r}
library("skimr")
skim(candy)
```

```{r}
skim(candy)
```
>q6: last column, winpercent, mean i s 50.3

> q7 `candy$chocolate` 1 means it has chocolate (true)

> q8 

```{r}
library(ggplot2)

ggplot(candy, aes(winpercent)) +
  geom_histogram(bins = 12) + 
  labs(title = "Histogram of Win Percentages",
       x = "competitor",
       y = "Win Percent") 
```

> q9 dist is not symmetrical: median
>q10 below

```{r}
median(candy$winpercent)
```

>q11 chocolate is higher on average than fruity

```{r}
cf<-candy$winpercent[as.logical(candy$fruity)]
cc<-candy$winpercent[as.logical(candy$chocolate)]
mean (cf)
mean(cc)
```

>q12, yes pval is very small and CI is above zero

```{r}
t.test(cc,cf)
```

> q13 Nik L Nip	
Boston Baked Beans
Chiclets
Super Bubble
Jawbusters

```{r}
 candy |> arrange(winpercent) |> head(5)
```

> q 14 Snickers	1	0	1	1	1	0	0	1	
Kit Kat	1	0	0	0	0	1	0	1	
Twix	1	0	1	0	0	1	0	1	
Reese's Miniatures	1	0	0	1	0	0	0	0	
Reese's Peanut Butter cup


```{r}
 candy |> arrange(winpercent) |> tail(5)
```

>q15

```{r}

ggplot(candy) + 
aes(winpercent, rownames(candy))+
  geom_col()
```

>q16 

```{r}

ggplot(candy) + 
aes(winpercent, reorder(rownames(candy),winpercent))+
  geom_col()
```
```{r}
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"

ggplot(candy) + 
  aes(winpercent, reorder(rownames(candy),winpercent)) +
  geom_col(fill=my_cols) 
```

>q17 sixlets
>q18 starburst ew!


```{r}
library(ggrepel)

# How about a plot of win vs price
ggplot(candy) +
  aes(winpercent, pricepercent, label=rownames(candy)) +
  geom_point(col=my_cols) + 
  geom_text_repel(col=my_cols, size=3.3, max.overlaps = 52)
```

>q19 Tootsie Roll Midgies	

```{r}
ord <- order(candy$pricepercent, decreasing=F)
head( candy[ord,c(11,12)], n=5 )
```

>q20 Nik L Nip	0.976	22.44534
Nestle Smarties	0.976	37.88719
Ring pop	0.965	35.29076
Hershey's Krackel	0.918	62.28448
Hershey's Milk Chocolate

```{r}
ord <- order(candy$pricepercent, decreasing = TRUE)
head( candy[ord,c(11,12)], n=5 )
```

>q21

```{r}
ggplot(candy) +
  aes(pricepercent, reorder(rownames(candy), pricepercent)) +
  geom_segment(aes(yend = reorder(rownames(candy), pricepercent), 
                   xend = 0), col="gray40") +
    geom_point()
```


```{r}
library(corrplot)
cij <- cor(candy)
corrplot(cij)
```

>Q22. fluribus & bar, fruity & bar, fruiy & chocolate < this one the most
>Q23. winpercent and chocolate or chocolate & bar

```{r}
pca <- prcomp(candy, scale=TRUE)
summary(pca)
pca$rotation[,1]
```
```{r}
plot(pca$x[,1:2], col=my_cols, pch=16)

```

```{r}
# new df with candy data and pca
my_data <- cbind(candy, pca$x[,1:3])

p <- ggplot(my_data) + 
        aes(x=PC1, y=PC2, 
            size=winpercent/100,  
            text=rownames(my_data),
            label=rownames(my_data)) +
        geom_point(col=my_cols)

p
```


```{r}
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 56)  + 
  theme(legend.position = "none") +
  labs(title="Halloween Candy PCA Space",
       subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
       caption="Data from 538")
library(plotly)
#ggplotly(p)
```

>q24 chocolate, bar, win percent, price. saw previously in correlation and in price / winning percent

```{r}
pca$rotation
```



 






















 




