---
title: "class10 structural bioinf pt1"
author: "Sylvia ho a18482382"
format: pdf
---

# pdb database
[prothein data bank](http://www.rcsb.org/) is main repo of biomol structure data
>q1 81, 13 % in pdb solved by x ray and em

>q2 1

```{r}
stats<- read.csv(url("https://tinyurl.com/pdbstats26"))
stat<- data.frame(stats)
```

```{r}
df <- stat[, -1]

n.sums<-colSums(df)
n<- n.sums/n.sums["Total"]
round(n, digits = 2)
```

>q3 1,173

## [molstar](https://molstar.org/viewer/)


![olstar 1hsb](1HSG.png)

>Q4: Water molecules normally have 3 atoms. Why do we see just one atom per water molecule in this structure? microscopy detected es not full nuclei

>Q5: There is a critical “conserved” water molecule in the binding site. Can you identify this water molecule? What residue number does this water molecule have 1552


![olstar hpv pr](1HPV.png)


> q6 gen img hiv pr cartoon colored by secondary strcuture, showing inhibitor (lignad) ball and stick

>q7 the asps at the secondary site, the loops on both sides

##bio3d

```{r}
library (bio3d)
hiv <- read.pdb("1hsg")
hiv
```
>Q7: How many amino acid residues are there in this pdb object?
- 128

>Q8: Name one of the two non-protein residues? 
- h2o, mk1

>Q9: How many protein chains are in this structure? 
- 2


```{r}
hide<- pdbseq(hiv)
attributes(hiv)
```

**bio3dview** pkg not yet on cran. can use **remotes** pkg ot install


```{r}
library(bio3dview)
library(NGLVieweR)

hid<- view.pdb(hiv) |>
  setSpin()
```
```{r}
# Select the important ASP 25 residue
sele <- atom.select(hiv, resno=25)

# and highlight them in spacefill representation
hides<- view.pdb(hiv, cols=c("navy","pink"), 
         highlight = sele,
         highlight.style = "spacefill") |>
  setRock()
```
## predict protein flex


```{r}
adk <- read.pdb("6s36")
# Perform flexiblity prediction
m <- nma(adk)
plot (m)
mktrj(m, file="adk_m7.pdb")
```
```{r}
hide3<- view.nma(m, pdb=adk)

```
>Q10. msa Which of the packages above is found only on BioConductor and not CRAN? 

>Q11. bio3dview Which of the above packages is not found on BioConductor or CRAN?: 

>Q12. TRUE Functions from the pak package can be used to install packages from GitHub and BitBucket? 

```{r}
library(bio3d)
aa <- get.seq("1ake_A")
aa
```

>Q13. 214 
How many amino acids are in this sequence, i.e. how long is this sequence? 

```{r}
# Blast or hmmer search 
#b <- blast.pdb(aa)
# Plot a summary of search results
#hits <- plot(b)
# List out some 'top hits'
#head(hits$pdb.id)
hits <- NULL
hits$pdb.id <- c('1AKE_A','6S36_A','6RZE_A','3HPR_A','1E4V_A','5EJE_A','1E4Y_A','3X2S_A','6HAP_A','6HAM_A','4K46_A','3GMT_A','4PZL_A')
```

```{r}
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
```


```{r}
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")

```
##annotate

```{r}
# Vector containing PDB database codes
ids <- basename.pdb(pdbs$id)

anno <- pdb.annotate(ids)
unique(anno$source)
anno
```





```{r}
# Perform PCA
pc.xray <- pca(pdbs)
plot(pc.xray)
```
```{r}
# Calculate RMSD
rd <- rmsd(pdbs)

# Structure-based clustering
hc.rd <- hclust(dist(rd))
grps.rd <- cutree(hc.rd, k=3)

plot(pc.xray, 1:2, col="grey50", bg=grps.rd, pch=21, cex=1)

```

```{r}
#Plotting results with ggplot2
library(ggplot2)
library(ggrepel)

df <- data.frame(PC1=pc.xray$z[,1], 
                 PC2=pc.xray$z[,2], 
                 col=as.factor(grps.rd),
                 ids=ids)

p <- ggplot(df) + 
  aes(PC1, PC2, col=col, label=ids) +
  geom_point(size=2) +
  geom_text_repel(max.overlaps = 50) +
  theme(legend.position = "none")
p
```

>Q14. What do you note about this plot? Are the black and colored lines similar or different? Where do you think they differ most and why?
- they are similar in pattern, the colored lines are taller and differ most in the 50-70 region. i think they might differ because they are more flexible.









